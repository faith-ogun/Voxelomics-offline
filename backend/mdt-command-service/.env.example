# =============================================================================
# Voxelomics MDT Command Service - Offline Local Only
# =============================================================================

# Core runtime
# - local: current direct local orchestrator (default)
# - adk_local: Google ADK orchestration + local model backend (LiteLLM/Ollama)
MDT_EXECUTION_MODE=local
MDT_MODEL_NAME=google/medgemma-4b-it
MDT_MEDGEMMA_MODEL_NAME=google/medgemma-4b-it
MDT_MEDGEMMA_LOCAL_MODEL_ID=../../models/medgemma-4b-it
MDT_MEDGEMMA_LOCAL_DEVICE=auto
MDT_MEDGEMMA_LOCAL_FILES_ONLY=true
MDT_MEDGEMMA_TIMEOUT_SECONDS=45
MDT_MEDGEMMA_MAX_OUTPUT_TOKENS=220
MDT_MEDGEMMA_MAX_INPUT_CHARS=22000
MDT_MEDGEMMA_TEMPERATURE=0.0
MDT_AGENT_CALL_TIMEOUT_SECONDS=180
MDT_AGENT_CALL_TIMEOUT_CAP_SECONDS=180
MDT_MEDGEMMA_STRICT_JSON_RETRIES=1
MDT_DISABLE_MEDGEMMA_ON_TIMEOUT=false
MDT_MODEL_ROUTER_MODE=medgemma_only
MDT_ANALYZE_TIMEOUT_SECONDS=900

# ADK local orchestration (used only when MDT_EXECUTION_MODE=adk_local)
MDT_ADK_MODEL_PROVIDER=ollama_chat
MDT_ADK_MODEL_NAME=qwen2.5:7b-instruct

# Local storage and uploads
MDT_LOCAL_DATA_DIR=./local_data
MDT_CASE_STORE_BACKEND=sqlite
MDT_SQLITE_DB_PATH=./local_data/mdt_cases.sqlite3
MDT_AUDIO_UPLOAD_BACKEND=local
MDT_LOCAL_AUDIO_DIR=./local_data/audio

# Retrieval (local evidence cache only)
MDT_RETRIEVAL_MODE=local
MDT_LOCAL_EVIDENCE_DIR=./local_data/evidence_cache
MDT_RETRIEVAL_TIMEOUT_SECONDS=8
MDT_RETRIEVAL_CACHE_TTL_SECONDS=3600
MDT_RETRIEVAL_CACHE_MAX_ENTRIES=512

# MedASR local
MDT_MEDASR_MODE=local
MDT_TRANSCRIPTION_ENGINE=medasr-local
MDT_MEDASR_LOCAL_MODEL_ID=../../models/medasr
MDT_MEDASR_LOCAL_DEVICE=auto
MDT_MEDASR_LOCAL_CHUNK_LENGTH_S=25
MDT_MEDASR_LOCAL_STRIDE_LENGTH_S=3
MDT_MEDASR_LOCAL_ALLOW_TEXT_FALLBACK=true
MDT_MEDASR_TIMEOUT_SECONDS=45
MDT_MEDASR_LOCAL_CTC_RETRY=false

# DiagnostiCore handoff
MDT_DIAGNOSTICORE_FETCH_MODE=file
MDT_DIAGNOSTICORE_ALLOW_FALLBACK=true
MDT_DIAGNOSTICORE_TIMEOUT_SECONDS=4
MDT_DIAGNOSTICORE_CASE_KEY_COLUMN=case_submitter_id
MDT_DIAGNOSTICORE_CASE_PREDICTIONS_CSV=../diagnosticore-service/output/pathfoundation_tp53_200/case_predictions_calibrated_platt.csv
MDT_DIAGNOSTICORE_CLINICAL_REPORT_JSON=../diagnosticore-service/output/pathfoundation_tp53_200/tp53_clinical_report_pathfoundation_platt.json

# Clinical reasoner
MDT_CLINICAL_REASONER_MODE=local
MDT_CLINICAL_REASONER_ALLOW_MOCK_FALLBACK=false

# Safety thresholds
MDT_CONSENSUS_LOW_CONFIDENCE_THRESHOLD=0.78
MDT_MIN_EVIDENCE_ITEMS=2
MDT_RED_FLAG_UNCERTAINTY_THRESHOLD=2
